!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("../texgen-schema/index.js"),require("../texgen/index.js")):"function"==typeof define&&define.amd?define(["exports","../texgen-schema/index.js","../texgen/index.js"],r):r(e.TG=e.TG||{},e.TG,e.TG)}(this,function(e,r,t){"use strict";function n(e,r){var t=e.slice(2).split("/"),n=r;return t.forEach(function(e){n=n[e]}),n}function i(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=e,o=r||e,a={};if(!t)throw new Error;if(t.$ref&&(t=n(t.$ref,o)),t.enum)return t.enum[Math.floor(c(t.enum.length)())];if("number"===t.type)return parseFloat(c(t.minimum||Number.MIN_VALUE,t.maximum||Number.MAX_VALUE)().toPrecision(2));if("integer"===t.type)return Math.floor(c(t.minimum||Number.MIN_VALUE,t.maximum||Number.MAX_VALUE)());if("boolean"===t.type)return 1===Math.floor(c(2)());if("array"===t.type){var m=t.items.length||Math.min(t.maxItems||8,Math.floor(c(t.minItems||1,(t.maxItems||8)+1)()));a=[];for(var s=0;s<m;s++){var u=t.items.length?t.items[s]:t.items,p=i(u,o);a.push(p)}return a}if(t.anyOf){var f=t.anyOf[Math.floor(c(t.anyOf.length)())];return i(f,o)}return t.properties&&Object.keys(t.properties).forEach(function(e){a[e]=i(t.properties[e],o)}),a}function o(){var e=i(r.getSchema());return TG.Programs.Generators[e.render[0].program.type]||(e.render[0].program={type:"Number"}),e}function a(){if(g)return g;var e={type:"object",properties:{render:{$ref:"#/definitions/texture"}},required:["render"],definitions:{operation:{},texture:{type:"array",minItems:3,maxItems:7,items:{type:"object",properties:{operation:{$ref:"#/definitions/operation"},tint:{$ref:"#/definitions/tint"},program:{anyOf:[]}},required:["operation","program"]}},tint:{type:"array",minItems:3,maxItems:4,items:{type:"number",minimum:0,maximum:1,default:.5}},color:{type:"array",minItems:3,maxItems:3,items:{type:"number",minimum:0,maximum:1,default:.5}},point:{type:"array",minItems:2,maxItems:8,items:{type:"array",items:[{type:"number",minimum:0,maximum:1,default:.5},{$ref:"#/definitions/color"}]},default:[[0,[0,0,0]],[.4,[1,1,1]],[.6,[1,1,1]],[1,[0,0,0]]]},interpolation:{enum:[0,1,2],default:1}}};e.definitions.operation.enum=Object.keys(t.Operations);var r=e.definitions.texture.items.properties.program.anyOf;return m(e,"generators",t.Programs.Generators,r,t),m(e,"filters",t.Programs.Filters,r,t),m(e,"mixers",t.Programs.Mixers,r,t),g=e,e}function m(e,r,t,n,i){Object.keys(t).forEach(function(o){n.push({$ref:"#/definitions/"+r+"/definitions/"+o}),e.definitions[r]=e.definitions[r]||{definitions:{}};var a=e.definitions[r].definitions[o]={properties:{type:{enum:[o]}},required:["type"]};t[o].params&&Object.keys(t[o].params).forEach(function(e){var r=a.properties[e]={},n=t[o].params[e],m={isArray:Array.isArray(n.val),type:n.type||0,min:isNaN(n.min)?-256:n.min,max:isNaN(n.max)?256:n.max,length:Array.isArray(n.val)?n.val.length:1,val:n.val};m.isArray?(r.type="array",r.items={type:m.type?"number":"integer",minimum:m.min,maximum:m.max},r.minItems=m.length,r.maxItems=m.length):m.type===i.Type.BOOLEAN?r.type="boolean":m.type===i.Type.COLOR_POINT?r.$ref="#/definitions/point":m.type===i.Type.INTERPOLATION?r.$ref="#/definitions/interpolation":m.type===i.Type.NUMBER?(r.type="number",r.minimum=m.min,r.maximum=m.max):m.type===i.Type.INT&&(r.type="integer",r.minimum=m.min,r.maximum=m.max),r.default=m.val}),"PutTexture"===o&&(a.properties.texture={$ref:"#/definitions/texture"})})}function s(e,r){var t={type:e.properties.type.enum[0]};return Object.keys(e.properties).filter(function(e){return"type"!==e}).forEach(function(i){var o=e.properties[i];o.$ref&&(o=n(o.$ref,r)),void 0!==o.default&&(t[i]=o.default)}),t}function u(){var e=a(),r=[];return p(r,e.definitions.generators.definitions,e),f(r,x({},r[v].render[0],{tint:[1,1,1]}),e.definitions.filters.definitions,e),l(r,x({},r[v].render[0]),x({},r[b].render[0])),y(r,x({},r[v].render[0],{tint:[1,1,.5]}),x({},r[b].render[0]),e.definitions.operation.enum),d(r,x({},r[v].render[0],{tint:[1,1,.5]}),x({},r[b].render[0])),r}function p(e,r,n){var i=0,o=Object.keys(r);o.forEach(function(o){var a=r[o],m=s(a,n);e.push({title:o,group:"Generators",render:[{tint:h[i++%h.length],operation:"set",program:m}]}),t[o]&&t[o].examples&&t[o].examples.forEach(function(r,t){var m=s(a,n);Object.keys(r).forEach(function(e){m[e]=r[e]}),e.push({title:o,subTitle:"#"+(t+1),group:"Generators",render:[{tint:h[i++%h.length],operation:"set",program:m}]})})})}function f(e,r,n,i){var o=Object.keys(n);o.map(function(o){var a=n[o],m=s(a,i);e.push({title:o,group:"Filters",render:[r,{tint:[1,1,1],operation:"set",program:m}]}),t[o]&&t[o].examples&&t[o].examples.forEach(function(t,n){var m=s(a,i);Object.keys(t).forEach(function(e){m[e]=t[e]}),e.push({title:o,subTitle:"#"+(n+1),group:"Filters",render:[r,{tint:[1,1,1],operation:"set",program:m}]})})})}function l(e,r,t){e.push({title:"PutTexture",group:"Mixers",render:[r,{tint:[1,1,1],operation:"add",program:{type:"PutTexture",texture:[t]}}]})}function y(e,r,t,n){n.map(function(n){e.push({title:n,group:"Operations",render:[r,{tint:[1,.5,1],operation:n,program:t.program}]})})}function d(e,r,t){[0,.25,.5,.75,1].forEach(function(n){e.push({title:"Alpha "+n,group:"Alpha Blending",render:[r,{tint:[1,.5,1,n],operation:"set",program:t.program}]})})}var c=function(e,r){return e=null==e?0:+e,r=null==r?1:+r,1===arguments.length?(r=e,e=0):r-=e,function(){return Math.random()*r+e}},g=null,h=[[0,.5,1],[0,1,.5],[0,1,1],[.5,0,1],[.5,1,0],[1,0,.5],[1,0,1],[1,.5,0],[1,1,0]],x=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},v=1,b=3;e.getRandom=o,e.getFeatures=u,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=texgen-generator.js.map
